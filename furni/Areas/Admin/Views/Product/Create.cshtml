@{
    ViewData["Title"] = "Index";
    Layout = "~/Areas/Admin/Shared/_Layout.cshtml";
}
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Tải thư viện DataTables -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.css">
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<div class="container-fluid">
    <h2 class="mt-3">Thêm Sản Phẩm</h2>
    <hr>

    <form id="createForm" asp-action="Create" method="post">
        <!-- Trường Product Name -->
        <div class="form-group">
            <label for="Name">Product Name</label>
            <input type="text" class="form-control" id="Name" name="Name" placeholder="Enter product name">
        </div>

        <!-- Trường Product Description -->
        <div class="form-group">
            <label for="Description">Product Description</label>
            <textarea class="form-control" id="Description" name="Description" placeholder="Enter product description"></textarea>
        </div>

        <!-- Trường Image URL -->
        <div class="form-group">
            <label for="ImageUrl">Image URL</label>
            <input type="text" class="form-control" id="ImageUrl" name="ImageUrl" placeholder="Enter image URL">
        </div>

        <!-- Trường Price -->
        <div class="form-group">
            <label for="Price">Price</label>
            <input type="number" step="0.01" class="form-control" id="Price" name="Price" placeholder="Enter product price">
        </div>

        <!-- Trường Stock Quantity -->
        <div class="form-group">
            <label for="StockQuantity">Stock Quantity</label>
            <input type="number" class="form-control" id="StockQuantity" name="StockQuantity" placeholder="Enter stock quantity">
        </div>

        <!-- Trường CategoryId -->
        <div class="form-group">
            <label for="CategoryId">Category</label>
            <select class="form-control" id="CategoryId" name="CategoryId">
                <option value="">-- Select category --</option>
                @foreach (var category in ViewBag.Categories)
                {
                    <option value="@category.Id">@category.Name</option>
                }
            </select>
        </div>

        <!-- Nút Submit -->
        <div class="form-group">
            <button type="submit" class="btn btn-primary">Create</button>
        </div>
    </form>


    @section Scripts {
        <script>
            $(document).ready(function () {
                $('#createForm').submit(function (event) {
                    event.preventDefault(); // Ngăn chặn form submit theo cách truyền thống

                    var formData = new FormData($(this)[0]); // Tạo đối tượng FormData từ form

                    $.ajax({
                        url: '/Admin/Product/Create', // Đường dẫn tới action Create trong controller Products
                        type: 'POST',
                        data: formData, // Gửi dữ liệu dưới dạng form data
                        contentType: false, // Không cần set contentType khi sử dụng FormData
                        processData: false, // Không xử lý dữ liệu trước khi gửi khi sử dụng FormData
                        success: function (response) {
                            if (response.success) {
                                alert(response.message); // Thông báo thành công
                                // Xử lý sau khi thêm sản phẩm thành công (ví dụ: làm mới trang)
                            } else { 
                                // Hiển thị thông báo lỗi
                                alert("Đã xảy ra lỗi: " + response.message);
                            }
                        },
                        error: function (xhr, status, error) {
                            // Xử lý lỗi
                            alert("Có lỗi xảy ra: " + error);
                        }
                    });
                });
            });
        </script>
    }
</div>
<!-- /.container-fluid -->